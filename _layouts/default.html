<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
        <title>{{ page.title }} â€“ SymphonyCMS</title>
        <link rel="icon" type="image/png" href="{{ site.baseurl }}/assets/img/bookmark.png">
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css" />
        <link media="screen" href="{{ site.baseurl }}/assets/css/codemirror.css" type="text/css" rel="stylesheet" />
        <link media="screen" href="{{ site.baseurl }}/assets/css/factory.css" type="text/css" rel="stylesheet" />
        <link media="screen" href="{{ site.baseurl }}/assets/css/factory.docs.css" type="text/css" rel="stylesheet" />
        <script type="text/javascript" src="{{ site.baseurl }}/assets/js/jquery.js"></script>
        <script type="text/javascript" src="{{ site.baseurl }}/assets/js/modernizr.js"></script>
        <script type="text/javascript" src="{{ site.baseurl }}/assets/js/codemirror.js"></script>
        <script type="text/javascript" src="{{ site.baseurl }}/assets/js/factory.js"></script>
        <script type="text/javascript" src="{{ site.baseurl }}/assets/js/factory.grid.js"></script>
    </head>
    <body>
        {% include network.html %}

        <div id="site">
            {% include header.html %}
            {{ content }}
        </div>

        {% include footer.html %}

        <script type="text/javascript">
var search = (function($){

    function getSearchJSON()
    {
        $.getJSON("{{ site.baseurl }}/search.json", function(e) {
            $("#search_results").html("");
            searchJSON = e;
        });
    }

    function doSearch(e)
    {
        results = [];

        if (e != "")
        {
            $.each(searchJSON, function(t, n) {
                var r = n.title, i = n.title.toLowerCase(), s = n.href, o = n.date;
                i.indexOf(e)!==-1 && results.push([r, s, o])
            });

            printResults();
        }
        else
        {
            $("#search_results").html();
            results = [];
            printResults();
        }
    }

    function printResults()
    {
        var e = $("#search_results");

        e.html("");

        e.html(function() {
            if (results.length == 0)
            {
                e.append('<li style="padding-top: 3px; padding-bottom: 3px"><a style="color: #999; word-wrap: break-word; white-space: normal" href="#">No results found</a></li>');
            }
            else
            {
                $.each(results, function(t, n) {
                    e.append('<li style="padding-top: 3px; padding-bottom: 3px"><a style="color: #999; word-wrap: break-word; white-space: normal" href="' + n[1] + '">' + n[0] + '</a></li>');
                });
            }
        });
    }

    $('#search_input').keyup(function(){
        if ($('#search_input').val() != '')
        {
            $('#search_results').show();
        }
        else
        {
            $('#search_results').hide();
        }
    });

    // Hide the dropdown menu if there is a left mouse click outside of it
    $(document).mouseup(function (e)
    {
        var container = $("#search_results");

        // if the target of the click isn't the
        // container nor a descendant of the container
        if (!container.is(e.target) && container.has(e.target).length === 0)
        {
            container.hide();
        }
    });

    $(document).ready(function() {
        // Create the search index on page load
        getSearchJSON();

        // Continually update search results as characters are typed
        $("#search_input").keyup(function() {
            // Make search inputs are case insensitive
            var e = $(this).val().toLowerCase();

            // Do the actual search
            doSearch(e);
        });
    });
})(jQuery);

</script>
    </body>
</html>
